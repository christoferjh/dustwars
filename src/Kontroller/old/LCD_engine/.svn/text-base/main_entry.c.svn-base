#include "lcd_engine.h"
#include <avr/io.h>
#include "connections.h"
#include "macros.h"
#include <util/delay.h>
#include "games.h"
#include "buttons.h"
#include "touch.h"
#include <avr/interrupt.h> 
#include "game_missile.h"
#include "system.h"
#include "gui.h"
#include <stdlib.h>
#include "demo3d.h"


void test_touch(LCD_engine *lcd);
void flash_finish();

void paint(LCD_engine *lcd);
void test_buttons(LCD_engine *lcd);
void draw_main_meny(LCD_engine *lcd);
void drawStartImage(LCD_engine *lcd);

ISR(TIMER0_OVF_vect) {
sys_time++;

if (TOUCH_STATE!=TOUCH_STATE_OFF){
start_reading_with_interrupt();
}
}

void gui_button_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
ButtonsMeny BMA;
BMA.title="Buttons";
BMA.RootButton=0;
MenyButton b[3];
b[0]=makeButton("Test",1);
//b[1]=makeButton("Test",2);
b[2]=makeButton("Back",3);
addMenyButton(&BMA, &b[2]);
//addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);
int valde=0;
while (1){
valde = Buttons_meny(lcd,&BMA,3);
if (valde==1){
//calibrate_touch(lcd);
test_buttons(lcd);
}else if (valde==2){
//test_buttons(lcd);
}else{
return;
}
}
}

void gui_touch_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
ButtonsMeny BMA;
BMA.title="Touch";
BMA.RootButton=0;
MenyButton b[3];
b[0]=makeButton("Calibrate",1);
b[1]=makeButton("Test",2);
b[2]=makeButton("Back",3);
addMenyButton(&BMA, &b[2]);
addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);
int valde=0;
while (1){
valde = Buttons_meny(lcd,&BMA,3);
if (valde==1){
calibrate_touch(lcd);
}else if (valde==2){
test_touch(lcd);
}else{
return;
}
}
}

void gui_screen_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
ButtonsMeny BMA;
BMA.title="Screen";
BMA.RootButton=0;
MenyButton b[3];
b[0]=makeButton("Reversed",1);
b[1]=makeButton("Test",2);
b[2]=makeButton("Back",3);
addMenyButton(&BMA, &b[2]);
//addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);
int valde=0;
while (1){
valde = Buttons_meny(lcd,&BMA,1);
if (valde==1){
if (lcd->DISPINVERTED){DisplaySetDispInverted(lcd, 0);
b[0].text="Reversed";
}else {DisplaySetDispInverted(lcd, 1);
b[0].text="Normal";
}

}else if (valde==2){
//test_touch(lcd);
}else{
return;
}
}
}

void gui_system_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
ButtonsMeny BMA;
BMA.title="System";
BMA.RootButton=0;
MenyButton b[4];
b[0]=makeButton("Touch",1);
b[1]=makeButton("Buttons",2);
b[2]=makeButton("Screen",3);
b[3]=makeButton("Back",4);
addMenyButton(&BMA, &b[3]);
addMenyButton(&BMA, &b[2]);
addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);
int valde=0;
while (1){
valde = Buttons_meny(lcd,&BMA,2);
if (valde==1){
gui_touch_meny(lcd);
}else if (valde==2){
gui_button_meny(lcd);
}else if (valde==3){
gui_screen_meny(lcd);
}else{
return;
}
}
}




void gui_games_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();



ButtonsMeny BMA;
BMA.title="Games";
BMA.RootButton=0;
MenyButton b[5];
b[0]=makeButton("Pong",1);
b[1]=makeButton("Missiles",2);
b[2]=makeButton("Paint",3);
b[3]=makeButton("3d",4);
b[4]=makeButton("Back",5);
addMenyButton(&BMA, &b[4]);
addMenyButton(&BMA, &b[3]);
addMenyButton(&BMA, &b[2]);
addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);

int valde=0;

while (1){

valde = Buttons_meny(lcd,&BMA,4);
if (valde==1){
game_ball(lcd);
}else if (valde==2){
game_missile(lcd);
}else if (valde==3){
paint(lcd);
}else if (valde==4){
start_3dDemo(lcd);
}else{
return;
}

}



}


void about(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
LCD_setPage(0);
rprintfStrCenter("This is the work of");
LCD_setPage(1);
rprintfStrCenter("Christofer");
LCD_setPage(2);
rprintfStrCenter("Johansson Hiitti");
LCD_setPage(3);
rprintfStrCenter("T08");

LCD_setPage(7);
rprintfStrCenter("FIM project 2011");


while (1){
if (START_isPressedAndRel()){
		drawStartImage(lcd);
		break;
		}

}


}

void main_gui_meny(LCD_engine *lcd){
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
LCD_setPage(0);
LCD_setColumn(0);
rprintfStr("meny");

ButtonsMeny BMA;
BMA.title="Main meny";
BMA.RootButton=0;
MenyButton b[3];
b[0]=makeButton("Games",1);
b[1]=makeButton("System",2);
b[2]=makeButton("About",3);
addMenyButton(&BMA, &b[2]);
addMenyButton(&BMA, &b[1]);
addMenyButton(&BMA, &b[0]);


int valde=0;

while (1){

valde = Buttons_meny(lcd,&BMA,4);
if (valde==1){
gui_games_meny(lcd);
}else if (valde==2){
//game_missile(lcd);
gui_system_meny(lcd);
}else if (valde==3){
//	calibrate_touch(lcd);
about(lcd);
}

}



}


void drawStartImage(LCD_engine *lcd){
//LCD_engine image;
//image.LCD_RAM
LCD_CLR();
LCD_RAM_CLR(lcd);
resetConnection();
setDubbelbuffer(lcd,1);
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
resetConnection();
unsigned char im[1024] = {

//,,,,



 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xE0     ,/*  ###_____  */
 0xF8     ,/*  #####___  */
 0xFC     ,/*  ######__  */
 0xFE     ,/*  #######_  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xE7     ,/*  ###__###  */
 0xEE     ,/*  ###_###_  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xF0     ,/*  ####____  */
 0xC0     ,/*  ##______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x81     ,/*  #______#  */
 0x79     ,/*  _####__#  */
 0x39     ,/*  __###__#  */
 0x03     ,/*  ______##  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x7F     ,/*  _#######  */
 0x01     ,/*  _______#  */
 0x79     ,/*  _####__#  */
 0x79     ,/*  _####__#  */
 0x79     ,/*  _####__#  */
 0x81     ,/*  #______#  */
 0x83     ,/*  #_____##  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFC     ,/*  ######__  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xC0     ,/*  ##______  */
 0xE0     ,/*  ###_____  */
 0xE0     ,/*  ###_____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF8     ,/*  #####___  */
 0xF8     ,/*  #####___  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xF0     ,/*  ####____  */
 0xE0     ,/*  ###_____  */
 0xE0     ,/*  ###_____  */
 0xC0     ,/*  ##______  */
 0xC0     ,/*  ##______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0xEF     ,/*  ###_####  */
 0x7F     ,/*  _#######  */
 0x1C     ,/*  ___###__  */
 0x78     ,/*  _####___  */
 0xF0     ,/*  ####____  */
 0xD0     ,/*  ##_#____  */
 0xD0     ,/*  ##_#____  */
 0xC0     ,/*  ##______  */
 0x68     ,/*  _##_#___  */
 0x68     ,/*  _##_#___  */
 0x20     ,/*  __#_____  */
 0x14     ,/*  ___#_#__  */
 0x14     ,/*  ___#_#__  */
 0x02     ,/*  ______#_  */
 0x08     ,/*  ____#___  */
 0x3F     ,/*  __######  */
 0xFF     ,/*  ########  */
 0xF7     ,/*  ####_###  */
 0xEF     ,/*  ###_####  */
 0xFF     ,/*  ########  */
 0xF8     ,/*  #####___  */
 0xE0     ,/*  ###_____  */
 0x80     ,/*  #_______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xF8     ,/*  #####___  */
 0xF8     ,/*  #####___  */
 0xF8     ,/*  #####___  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xE0     ,/*  ###_____  */
 0xFC     ,/*  ######__  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x7F     ,/*  _#######  */
 0xCF     ,/*  ##__####  */
 0xFC     ,/*  ######__  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFE     ,/*  #######_  */
 0xFE     ,/*  #######_  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xF8     ,/*  #####___  */
 0xF8     ,/*  #####___  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xFC     ,/*  ######__  */
 0xFE     ,/*  #######_  */
 0xFE     ,/*  #######_  */
 0x1E     ,/*  ___####_  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xC0     ,/*  ##______  */
 0x70     ,/*  _###____  */
 0xB8     ,/*  #_###___  */
 0xFC     ,/*  ######__  */
 0xFF     ,/*  ########  */
 0x3F     ,/*  __######  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x07     ,/*  _____###  */
 0x1F     ,/*  ___#####  */
 0x7F     ,/*  _#######  */
 0xFF     ,/*  ########  */
 0xEF     ,/*  ###_####  */
 0xDF     ,/*  ##_#####  */
 0x7F     ,/*  _#######  */
 0xFC     ,/*  ######__  */
 0xF8     ,/*  #####___  */
 0xF0     ,/*  ####____  */
 0xC0     ,/*  ##______  */
 0x80     ,/*  #_______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xC0     ,/*  ##______  */
 0xDE     ,/*  ##_####_  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xEF     ,/*  ###_####  */
 0xEF     ,/*  ###_####  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xF7     ,/*  ####_###  */
 0xF7     ,/*  ####_###  */
 0xFF     ,/*  ########  */
 0xEF     ,/*  ###_####  */
 0xEF     ,/*  ###_####  */
 0xFF     ,/*  ########  */
 0xDF     ,/*  ##_#####  */
 0xFF     ,/*  ########  */
 0xBF     ,/*  #_######  */
 0x3F     ,/*  __######  */
 0xE7     ,/*  ###__###  */
 0xFE     ,/*  #######_  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x7F     ,/*  _#######  */
 0x0F     ,/*  ____####  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0xE0     ,/*  ###_____  */
 0xF8     ,/*  #####___  */
 0x1E     ,/*  ___####_  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x1F     ,/*  ___#####  */
 0x03     ,/*  ______##  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x03     ,/*  ______##  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xF1     ,/*  ####___#  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFC     ,/*  ######__  */
 0xC0     ,/*  ##______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0xF8     ,/*  #####___  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x9F     ,/*  #__#####  */
 0xF3     ,/*  ####__##  */
 0xFE     ,/*  #######_  */
 0xFF     ,/*  ########  */
 0xFE     ,/*  #######_  */
 0xFF     ,/*  ########  */
 0xFD     ,/*  ######_#  */
 0xFF     ,/*  ########  */
 0xFB     ,/*  #####_##  */
 0xFB     ,/*  #####_##  */
 0xFB     ,/*  #####_##  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFB     ,/*  #####_##  */
 0xFB     ,/*  #####_##  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x7D     ,/*  _#####_#  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0x40     ,/*  _#______  */
 0x4F     ,/*  _#__####  */
 0x37     ,/*  __##_###  */
 0x0F     ,/*  ____####  */
 0x0E     ,/*  ____###_  */
 0x1B     ,/*  ___##_##  */
 0x77     ,/*  _###_###  */
 0xE0     ,/*  ###_____  */
 0xC0     ,/*  ##______  */
 0x80     ,/*  #_______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0x30     ,/*  __##____  */
 0x10     ,/*  ___#____  */
 0x3B     ,/*  __###_##  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFC     ,/*  ######__  */
 0xFF     ,/*  ########  */
 0xFB     ,/*  #####_##  */
 0x7F     ,/*  _#######  */
 0x7F     ,/*  _#######  */
 0x9F     ,/*  #__#####  */
 0x0F     ,/*  ____####  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x3C     ,/*  __####__  */
 0x3F     ,/*  __######  */
 0x3F     ,/*  __######  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x3F     ,/*  __######  */
 0x3F     ,/*  __######  */
 0x7F     ,/*  _#######  */
 0x7F     ,/*  _#######  */
 0xCF     ,/*  ##__####  */
 0xF9     ,/*  #####__#  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0xFF     ,/*  ########  */
 0x3F     ,/*  __######  */
 0x03     ,/*  ______##  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xFE     ,/*  #######_  */
 0xE2     ,/*  ###___#_  */
 0x02     ,/*  ______#_  */
 0x01     ,/*  _______#  */
 0x01     ,/*  _______#  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x01     ,/*  _______#  */
 0x07     ,/*  _____###  */
 0x1F     ,/*  ___#####  */
 0x3E     ,/*  __#####_  */
 0xFE     ,/*  #######_  */
 0x3C     ,/*  __####__  */
 0x80     ,/*  #_______  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x80     ,/*  #_______  */
 0xC0     ,/*  ##______  */
 0xE0     ,/*  ###_____  */
 0xE0     ,/*  ###_____  */
 0xFF     ,/*  ########  */
 0xF8     ,/*  #####___  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x01     ,/*  _______#  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x01     ,/*  _______#  */
 0x07     ,/*  _____###  */
 0x0C     ,/*  ____##__  */
 0x08     ,/*  ____#___  */
 0x10     ,/*  ___#____  */
 0xA0     ,/*  #_#_____  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x01     ,/*  _______#  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x07     ,/*  _____###  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x03     ,/*  ______##  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x02     ,/*  ______#_  */
 0x07     ,/*  _____###  */
 0x08     ,/*  ____#___  */
 0x08     ,/*  ____#___  */
 0x08     ,/*  ____#___  */
 0x08     ,/*  ____#___  */
 0x18     ,/*  ___##___  */
 0x10     ,/*  ___#____  */
 0x10     ,/*  ___#____  */
 0x10     ,/*  ___#____  */
 0x30     ,/*  __##____  */
 0x20     ,/*  __#_____  */
 0x20     ,/*  __#_____  */
 0x60     ,/*  _##_____  */
 0x40     ,/*  _#______  */
 0x40     ,/*  _#______  */
 0xC0     ,/*  ##______  */
 0xC0     ,/*  ##______  */
 0x60     ,/*  _##_____  */
 0x30     ,/*  __##____  */
 0x3F     ,/*  __######  */
 0x1C     ,/*  ___###__  */
 0x1F     ,/*  ___#####  */
 0x1F     ,/*  ___#####  */
 0x1E     ,/*  ___####_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0E     ,/*  ____###_  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x0F     ,/*  ____####  */
 0x1F     ,/*  ___#####  */
 0x18     ,/*  ___##___  */
 0x7F     ,/*  _#######  */
 0x79     ,/*  _####__#  */
 0xE0     ,/*  ###_____  */
 0xC0     ,/*  ##______  */
 0xC0     ,/*  ##______  */
 0xC0     ,/*  ##______  */
 0x60     ,/*  _##_____  */
 0x60     ,/*  _##_____  */
 0x30     ,/*  __##____  */
 0x18     ,/*  ___##___  */
 0x0C     ,/*  ____##__  */
 0x04     ,/*  _____#__  */
 0x06     ,/*  _____##_  */
 0x02     ,/*  ______#_  */
 0x02     ,/*  ______#_  */
 0x01     ,/*  _______#  */
 0x01     ,/*  _______#  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     /*  ________  */
};

unsigned char im2[32]= {

//,,,,



 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0xE4     ,/*  ###__#__  */
 0xFC     ,/*  ######__  */
 0x7C     ,/*  _#####__  */
 0x3C     ,/*  __####__  */
 0x7C     ,/*  _#####__  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x1C     ,/*  ___###__  */
 0x1C     ,/*  ___###__  */
 0x78     ,/*  _####___  */
 0xF0     ,/*  ####____  */
 0xE0     ,/*  ###_____  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x07     ,/*  _____###  */
 0x0F     ,/*  ____####  */
 0x1E     ,/*  ___####_  */
 0x38     ,/*  __###___  */
 0x38     ,/*  __###___  */
 0x00     ,/*  ________  */
 0x00     ,/*  ________  */
 0x3E     ,/*  __#####_  */
 0x3C     ,/*  __####__  */
 0x3E     ,/*  __#####_  */
 0x3F     ,/*  __######  */
 0x27     ,/*  __#__###  */
 0x00     ,/*  ________  */
 0x00     /*  ________  */
};
//image.LCD_RAM=im;
LCD_drawImageToRam(lcd,im);
//for (int i=0;i<5;i++)
//	LCD_draw16x16ImageToRam(lcd,im2,i*16,i);

//for (int i=0;i<5;i++)
//	LCD_draw16x16ImageToRam(lcd,im2,i*16,i+5+40);

pushRAM(lcd);

while (1){if (START_isPressedAndRel()){break;}};

}

int main(void){
flash_finish();
LCD_engine *lcd = init_lcd();
button_init();

//Init the sys_time
TCCR0B=0b00000011; //64 prescaler
TIMSK0=0x01;
sei();

touch_init_advance();


draw_main_meny(lcd);


//start_3dDemo(lcd);//TEMPORARY



unsigned char starts=eeprom_read(10);
if (starts==255){//just flashed...
set_calibration(37,164,47,86);
calibrate_touch(lcd);

}
if (starts!=254){
eeprom_write(10,starts+1);
}

LCD_setPage(3);
LCD_setColumn(0);
rprintfStr("eeprom:");
rprintfInt(starts);
//test_buttons(lcd);



//

drawStartImage(lcd);



main_gui_meny(lcd);


while (1){
	//if (~R_BUTTONS&(1<<B_A)){
	if (A_isPressed()){
	DisplaySetDispInverted(lcd, 1);
	DOGDATA;
		game_ball(lcd);
		draw_main_meny(lcd);
	}
	if (RIGHT_isPressed()){
		//calibrate_touch(lcd);
		game_missile(lcd);
		draw_main_meny(lcd);
	}
	if (B_isPressed()){
		calibrate_touch(lcd);
		draw_main_meny(lcd);
		gui_meny_demo(lcd);
	}
	if (LEFT_isPressed()){
		//test_touch(lcd);
		//calibrate_touch(lcd);
		paint(lcd);
		draw_main_meny(lcd);
	}
	if (UP_isPressed()){
		//test_touch(lcd);
		calibrate_touch(lcd);
		draw_main_meny(lcd);
		//paint(lcd);
	}
	if (DOWN_isPressed()){
		//test_touch(lcd);
		main_gui_meny(lcd);
		draw_main_meny(lcd);
		//calibrate_touch(lcd);
		//paint(lcd);
	}
}



while(1){}

}

void draw_main_meny(LCD_engine *lcd){
LCD_CLR();
//LCD_RAM_CLR();
DOGENABLE;
LCD_setPage(0);
LCD_setColumn(10);
rprintfStr("Hello lcd_engine!Ö");
LCD_setPage(1);
LCD_setColumn(0);
rprintfStr("press A for PONG");
LCD_setPage(2);
LCD_setColumn(0);
rprintfStr("press B for TOUCH-test");
}


void test_buttons(LCD_engine *lcd){

LCD_CLR();
DOGENABLE;
LCD_setPage(0);
LCD_setColumn(10);rprintfStr("Test Buttons ");
LCD_setPage(1);
LCD_setColumn(10);rprintfStr("START and touch to exit");
LCD_setPage(3);
LCD_setColumn(10);

while (1){LCD_setColumn(10);
rprintfBin(R_BUTTONS);rprintfStr("        ");
if (TOUCH_STATE==TOUCH_STATE_PRESSED && START_isPressedAndRel()){
return;
}

}
}

void flash_finish(){

}

void draw_cross(LCD_engine *lcd,int x,int y){
LCD_drawLine(lcd,x-5,y,x+5,y);
LCD_drawLine(lcd,x,y-5,x,y+5);
}


void paint(LCD_engine *lcd){

LCD_CLR();
LCD_RAM_CLR(lcd);
DOGENABLE;
pixelSetOrClearOrInvert(lcd,SET_PIXELS);
//ADCSRA|=0b01000000; //start 
Point p;
Point old_points[4];

for (int i=0;i<4;i++){
		old_points[i].x=0;
		old_points[i].y=0;
		old_points[i].down_count=0;
	}

while (1){
if (START_isPressedAndRel()){
		break;
		}

if (TOUCH_STATE==TOUCH_STATE_PRESSED){

p=getTouch();
if (p.down_count>10){

if (p.down_count!=old_points[0].down_count){
//save old
for (int i=3;i>0;i--){
old_points[i].x=old_points[i-1].x;
old_points[i].y=old_points[i-1].y;
}
old_points[0].x=p.x;
old_points[0].y=p.y;
old_points[0].down_count=p.down_count;
}

//p=getTouch();



//LCD_drawLine(lcd,p_1.x,p_1.y,(unsigned int)p.x,(unsigned int)p.y);

if (old_points[3].x!=0 && old_points[3].y!=0){
LCD_drawPixel(lcd,(unsigned int)old_points[2].x,(unsigned int)old_points[2].y);
LCD_drawLine(lcd,(unsigned int)old_points[3].x,(unsigned int)old_points[3].y,(unsigned int)old_points[2].x,(unsigned int)old_points[2].y);
}
}
}else {
for (int i=0;i<4;i++){
old_points[i].x=0;
old_points[i].y=0;
}
}



pushRAM(lcd);

}



}

void test_touch(LCD_engine *lcd){
//touch_init();
//get_touch_x();
LCD_CLR();
//LCD_RAM_CLR();
DOGENABLE;
LCD_setPage(0);
LCD_setColumn(10);
rprintfStr("Hello TOUCH-test!ö");
//set_y_reading();
//ADCSRA|=0b01000000; //start 
//int max=0;
//int x;
//get_touch_y();
while (1){
if (START_isPressed()){
		break;
		}
//x=get_touch_x();
//if (XX>max)
//	max=XX;
LCD_setPage(1);
LCD_setColumn(10);
rprintfStr("t:");rprintfInt(sys_time);rprintfStr("      ");
LCD_setPage(2);
LCD_setColumn(10);
if (TOUCH_STATE==TOUCH_STATE_PRESSED){
Point p=getRawTouch();

rprintfStr("P ");rprintfInt(p.x);rprintfStr(",");rprintfInt(p.y);rprintfStr("      ");
}
LCD_setPage(3);
LCD_setColumn(10);
rprintfInt(ddd);rprintfStr("  ");
LCD_setPage(4);
LCD_setColumn(10);
rprintfInt(ADCH);rprintfStr("  ");
}
}
